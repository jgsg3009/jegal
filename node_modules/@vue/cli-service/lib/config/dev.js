module.exports = (api, options) => {
  api.chainWebpack(webpackConfig => {
<<<<<<< HEAD
    if (process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test') {
      webpackConfig
        .devtool('cheap-module-eval-source-map')
        .output
          .publicPath(options.publicPath)
=======
    if (process.env.NODE_ENV === 'development') {
      webpackConfig
        .devtool('cheap-module-eval-source-map')
        .output
          .publicPath(options.baseUrl)
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361

      webpackConfig
        .plugin('hmr')
          .use(require('webpack/lib/HotModuleReplacementPlugin'))

<<<<<<< HEAD
      // https://github.com/webpack/webpack/issues/6642
      // https://github.com/vuejs/vue-cli/issues/3539
      webpackConfig
        .output
          .globalObject(`(typeof self !== 'undefined' ? self : this)`)
=======
      webpackConfig
        .plugin('no-emit-on-errors')
          .use(require('webpack/lib/NoEmitOnErrorsPlugin'))
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361

      if (!process.env.VUE_CLI_TEST && options.devServer.progress !== false) {
        webpackConfig
          .plugin('progress')
          .use(require('webpack/lib/ProgressPlugin'))
      }
    }
  })
}
