"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.remove = remove;
exports._removeFromScope = _removeFromScope;
exports._callRemovalHooks = _callRemovalHooks;
exports._remove = _remove;
exports._markRemoved = _markRemoved;
exports._assertUnremoved = _assertUnremoved;

var _removalHooks = require("./lib/removal-hooks");

<<<<<<< HEAD
var _index = require("./index");

=======
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
function remove() {
  this._assertUnremoved();

  this.resync();

<<<<<<< HEAD
  if (!this.opts || !this.opts.noScope) {
    this._removeFromScope();
  }
=======
  this._removeFromScope();
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361

  if (this._callRemovalHooks()) {
    this._markRemoved();

    return;
  }

  this.shareCommentsWithSiblings();

  this._remove();

  this._markRemoved();
}

function _removeFromScope() {
  const bindings = this.getBindingIdentifiers();
  Object.keys(bindings).forEach(name => this.scope.removeBinding(name));
}

function _callRemovalHooks() {
<<<<<<< HEAD
  for (const fn of _removalHooks.hooks) {
=======
  var _arr = _removalHooks.hooks;

  for (var _i = 0; _i < _arr.length; _i++) {
    const fn = _arr[_i];
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
    if (fn(this, this.parentPath)) return true;
  }
}

function _remove() {
  if (Array.isArray(this.container)) {
    this.container.splice(this.key, 1);
    this.updateSiblingKeys(this.key, -1);
  } else {
    this._replaceWith(null);
  }
}

function _markRemoved() {
<<<<<<< HEAD
  this._traverseFlags |= _index.SHOULD_SKIP | _index.REMOVED;
=======
  this.shouldSkip = true;
  this.removed = true;
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
  this.node = null;
}

function _assertUnremoved() {
  if (this.removed) {
    throw this.buildCodeFrameError("NodePath has been removed so is read-only.");
  }
}