'use strict';

var keys = require('object-keys');
<<<<<<< HEAD
var hasSymbols = typeof Symbol === 'function' && typeof Symbol('foo') === 'symbol';

var toStr = Object.prototype.toString;
var concat = Array.prototype.concat;
var origDefineProperty = Object.defineProperty;
=======
var foreach = require('foreach');
var hasSymbols = typeof Symbol === 'function' && typeof Symbol() === 'symbol';

var toStr = Object.prototype.toString;
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361

var isFunction = function (fn) {
	return typeof fn === 'function' && toStr.call(fn) === '[object Function]';
};

var arePropertyDescriptorsSupported = function () {
	var obj = {};
	try {
<<<<<<< HEAD
		origDefineProperty(obj, 'x', { enumerable: false, value: obj });
		// eslint-disable-next-line no-unused-vars, no-restricted-syntax
		for (var _ in obj) { // jscs:ignore disallowUnusedVariables
			return false;
		}
=======
		Object.defineProperty(obj, 'x', { enumerable: false, value: obj });
        /* eslint-disable no-unused-vars, no-restricted-syntax */
        for (var _ in obj) { return false; }
        /* eslint-enable no-unused-vars, no-restricted-syntax */
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
		return obj.x === obj;
	} catch (e) { /* this is IE 8. */
		return false;
	}
};
<<<<<<< HEAD
var supportsDescriptors = origDefineProperty && arePropertyDescriptorsSupported();
=======
var supportsDescriptors = Object.defineProperty && arePropertyDescriptorsSupported();
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361

var defineProperty = function (object, name, value, predicate) {
	if (name in object && (!isFunction(predicate) || !predicate())) {
		return;
	}
	if (supportsDescriptors) {
<<<<<<< HEAD
		origDefineProperty(object, name, {
=======
		Object.defineProperty(object, name, {
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
			configurable: true,
			enumerable: false,
			value: value,
			writable: true
		});
	} else {
		object[name] = value;
	}
};

var defineProperties = function (object, map) {
	var predicates = arguments.length > 2 ? arguments[2] : {};
	var props = keys(map);
	if (hasSymbols) {
<<<<<<< HEAD
		props = concat.call(props, Object.getOwnPropertySymbols(map));
	}
	for (var i = 0; i < props.length; i += 1) {
		defineProperty(object, props[i], map[props[i]], predicates[props[i]]);
	}
=======
		props = props.concat(Object.getOwnPropertySymbols(map));
	}
	foreach(props, function (name) {
		defineProperty(object, name, map[name], predicates[name]);
	});
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
};

defineProperties.supportsDescriptors = !!supportsDescriptors;

module.exports = defineProperties;
