var TYPE = require('../../tokenizer').TYPE;

<<<<<<< HEAD
var IDENT = TYPE.Ident;
var NUMBER = TYPE.Number;
var DIMENSION = TYPE.Dimension;
var LEFTPARENTHESIS = TYPE.LeftParenthesis;
var RIGHTPARENTHESIS = TYPE.RightParenthesis;
var COLON = TYPE.Colon;
var DELIM = TYPE.Delim;
=======
var IDENTIFIER = TYPE.Identifier;
var NUMBER = TYPE.Number;
var LEFTPARENTHESIS = TYPE.LeftParenthesis;
var RIGHTPARENTHESIS = TYPE.RightParenthesis;
var COLON = TYPE.Colon;
var SOLIDUS = TYPE.Solidus;
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361

module.exports = {
    name: 'MediaFeature',
    structure: {
        name: String,
        value: ['Identifier', 'Number', 'Dimension', 'Ratio', null]
    },
    parse: function() {
        var start = this.scanner.tokenStart;
        var name;
        var value = null;

<<<<<<< HEAD
        this.eat(LEFTPARENTHESIS);
        this.scanner.skipSC();

        name = this.consume(IDENT);
        this.scanner.skipSC();

        if (this.scanner.tokenType !== RIGHTPARENTHESIS) {
            this.eat(COLON);
=======
        this.scanner.eat(LEFTPARENTHESIS);
        this.scanner.skipSC();

        name = this.scanner.consume(IDENTIFIER);
        this.scanner.skipSC();

        if (this.scanner.tokenType !== RIGHTPARENTHESIS) {
            this.scanner.eat(COLON);
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
            this.scanner.skipSC();

            switch (this.scanner.tokenType) {
                case NUMBER:
<<<<<<< HEAD
                    if (this.lookupNonWSType(1) === DELIM) {
=======
                    if (this.scanner.lookupType(1) === IDENTIFIER) {
                        value = this.Dimension();
                    } else if (this.scanner.lookupNonWSType(1) === SOLIDUS) {
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
                        value = this.Ratio();
                    } else {
                        value = this.Number();
                    }

                    break;

<<<<<<< HEAD
                case DIMENSION:
                    value = this.Dimension();
                    break;

                case IDENT:
=======
                case IDENTIFIER:
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
                    value = this.Identifier();

                    break;

                default:
<<<<<<< HEAD
                    this.error('Number, dimension, ratio or identifier is expected');
=======
                    this.scanner.error('Number, dimension, ratio or identifier is expected');
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
            }

            this.scanner.skipSC();
        }

<<<<<<< HEAD
        this.eat(RIGHTPARENTHESIS);
=======
        this.scanner.eat(RIGHTPARENTHESIS);
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361

        return {
            type: 'MediaFeature',
            loc: this.getLocation(start, this.scanner.tokenStart),
            name: name,
            value: value
        };
    },
<<<<<<< HEAD
    generate: function(node) {
        this.chunk('(');
        this.chunk(node.name);
        if (node.value !== null) {
            this.chunk(':');
            this.node(node.value);
        }
        this.chunk(')');
=======
    generate: function(processChunk, node) {
        processChunk('(');
        processChunk(node.name);
        if (node.value !== null) {
            processChunk(':');
            this.generate(processChunk, node.value);
        }
        processChunk(')');
>>>>>>> 99ef3b4711c8dcd2f717e43dd012712d1f333361
    }
};
